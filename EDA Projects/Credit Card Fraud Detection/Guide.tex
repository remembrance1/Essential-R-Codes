\documentclass[11pt,]{article}
\usepackage[left=1in,top=1in,right=1in,bottom=1in]{geometry}
\newcommand*{\authorfont}{\fontfamily{phv}\selectfont}
\usepackage[]{mathpazo}


  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}



\usepackage{abstract}
\renewcommand{\abstractname}{}    % clear the title
\renewcommand{\absnamepos}{empty} % originally center

\renewenvironment{abstract}
 {{%
    \setlength{\leftmargin}{0mm}
    \setlength{\rightmargin}{\leftmargin}%
  }%
  \relax}
 {\endlist}

\makeatletter
\def\@maketitle{%
  \newpage
%  \null
%  \vskip 2em%
%  \begin{center}%
  \let \footnote \thanks
    {\fontsize{18}{20}\selectfont\raggedright  \setlength{\parindent}{0pt} \@title \par}%
}
%\fi
\makeatother




\setcounter{secnumdepth}{0}

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}

\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}

\title{Credit Card Fraud Detection - XGBOOST \thanks{PDF is available on EY FDA shared drive. \textbf{Current version}: March
11, 2019; \textbf{Corresponding author}:
\href{mailto:javier.ng@sg.ey.com}{\nolinkurl{javier.ng@sg.ey.com}}.}  }



\author{\Large Javier Ng\vspace{0.05in} \newline\normalsize\emph{EY}  }


\date{}

\usepackage{titlesec}

\titleformat*{\section}{\normalsize\bfseries}
\titleformat*{\subsection}{\normalsize\itshape}
\titleformat*{\subsubsection}{\normalsize\itshape}
\titleformat*{\paragraph}{\normalsize\itshape}
\titleformat*{\subparagraph}{\normalsize\itshape}


\usepackage{natbib}
\bibliographystyle{plainnat}
\usepackage[strings]{underscore} % protect underscores in most circumstances



\newtheorem{hypothesis}{Hypothesis}
\usepackage{setspace}

\makeatletter
\@ifpackageloaded{hyperref}{}{%
\ifxetex
  \PassOptionsToPackage{hyphens}{url}\usepackage[setpagesize=false, % page size defined by xetex
              unicode=false, % unicode breaks when used with xetex
              xetex]{hyperref}
\else
  \PassOptionsToPackage{hyphens}{url}\usepackage[unicode=true]{hyperref}
\fi
}

\@ifpackageloaded{color}{
    \PassOptionsToPackage{usenames,dvipsnames}{color}
}{%
    \usepackage[usenames,dvipsnames]{color}
}
\makeatother
\hypersetup{breaklinks=true,
            bookmarks=true,
            pdfauthor={Javier Ng (EY)},
             pdfkeywords = {xgboost, machine learning, R},  
            pdftitle={Credit Card Fraud Detection - XGBOOST},
            colorlinks=true,
            citecolor=blue,
            urlcolor=blue,
            linkcolor=magenta,
            pdfborder={0 0 0}}
\urlstyle{same}  % don't use monospace font for urls

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

\usepackage{booktabs} \usepackage{longtable} \usepackage{array}
\usepackage{multirow} \usepackage[table]{xcolor} \usepackage{wrapfig}
\usepackage{float} \floatplacement{figure}{H}


% add tightlist ----------
\providecommand{\tightlist}{%
\setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

\begin{document}
	
% \pagenumbering{arabic}% resets `page` counter to 1 
%
% \maketitle

{% \usefont{T1}{pnc}{m}{n}
\setlength{\parindent}{0pt}
\thispagestyle{plain}
{\fontsize{18}{20}\selectfont\raggedright 
\maketitle  % title \par  

}

{
   \vskip 13.5pt\relax \normalsize\fontsize{11}{12} 
\textbf{\authorfont Javier Ng} \hskip 15pt \emph{\small EY}   

}

}








\begin{abstract}

    \hbox{\vrule height .2pt width 39.14pc}

    \vskip 8.5pt % \small 

\noindent The datasets contains transactions made by credit cards in September
2013 by european cardholders. This dataset presents transactions that
occurred in two days, where we have 492 frauds out of 284,807
transactions. The dataset is highly unbalanced, the positive class
(frauds) account for 0.172\% of all transactions.


\vskip 8.5pt \noindent \emph{Keywords}: xgboost, machine learning, R \par

    \hbox{\vrule height .2pt width 39.14pc}



\end{abstract}


\vskip 6.5pt


\noindent  \subsection{Overview}\label{overview}

\subsection{Loading of Libraries}\label{loading-of-libraries}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{setwd}\NormalTok{(}\StringTok{"C:/Users/zm679xs/Desktop/R/Essential-R-Codes/EDA Projects/Credit Card Fraud Detection"}\NormalTok{)}
\KeywordTok{library}\NormalTok{(ggplot2) }\CommentTok{# Data visualization}
\KeywordTok{library}\NormalTok{(readr) }\CommentTok{# CSV file I/O, e.g. the read_csv function}
\KeywordTok{library}\NormalTok{(caret)}
\KeywordTok{library}\NormalTok{(DMwR) }\CommentTok{# smote}
\KeywordTok{library}\NormalTok{(xgboost)}
\KeywordTok{library}\NormalTok{(Matrix)}
\KeywordTok{library}\NormalTok{(reshape) }\CommentTok{#melt}
\KeywordTok{library}\NormalTok{(pROC) }\CommentTok{# AUC}

\CommentTok{# Input data files are available in the "../input/" directory.}
\CommentTok{# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory}
\KeywordTok{load}\NormalTok{(}\StringTok{"ccdata.RData"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsection{Split Data}\label{split-data}

Split data into train, test and cv using caret.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{## split into train, test, cv}
\KeywordTok{set.seed}\NormalTok{(}\DecValTok{1900}\NormalTok{)}
\NormalTok{inTrain <-}\StringTok{ }\KeywordTok{createDataPartition}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ ccdata}\OperatorTok{$}\NormalTok{Class, }\DataTypeTok{p =}\NormalTok{ .}\DecValTok{6}\NormalTok{, }\DataTypeTok{list =}\NormalTok{ F) }\CommentTok{#60% train}
\NormalTok{train <-}\StringTok{ }\NormalTok{ccdata[inTrain,]}
\NormalTok{testcv <-}\StringTok{ }\NormalTok{ccdata[}\OperatorTok{-}\NormalTok{inTrain,]}
\NormalTok{inTest <-}\StringTok{ }\KeywordTok{createDataPartition}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ testcv}\OperatorTok{$}\NormalTok{Class, }\DataTypeTok{p =}\NormalTok{ .}\DecValTok{5}\NormalTok{, }\DataTypeTok{list =}\NormalTok{ F) }\CommentTok{#20% test}
\NormalTok{test <-}\StringTok{ }\NormalTok{testcv[inTest,]}
\NormalTok{cv <-}\StringTok{ }\NormalTok{testcv[}\OperatorTok{-}\NormalTok{inTest,]}
\NormalTok{train}\OperatorTok{$}\NormalTok{Class <-}\StringTok{ }\KeywordTok{as.factor}\NormalTok{(train}\OperatorTok{$}\NormalTok{Class)}
\KeywordTok{rm}\NormalTok{(inTrain, inTest, testcv) }\CommentTok{#20% cv}
\end{Highlighting}
\end{Shaded}

\subsection{Imbalance Dataset}\label{imbalance-dataset}

Using SMOTE to make the dataset more balanced.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#using SMOTE instead}
\NormalTok{i <-}\StringTok{ }\KeywordTok{grep}\NormalTok{(}\StringTok{"Class"}\NormalTok{, }\KeywordTok{colnames}\NormalTok{(train)) }\CommentTok{# Get index Class column}
\NormalTok{train_smote <-}\StringTok{ }\KeywordTok{SMOTE}\NormalTok{(Class }\OperatorTok{~}\StringTok{ }\NormalTok{., }\KeywordTok{as.data.frame}\NormalTok{(train), }\DataTypeTok{perc.over =} \DecValTok{20000}\NormalTok{, }\DataTypeTok{perc.under=}\DecValTok{100}\NormalTok{)}
\KeywordTok{table}\NormalTok{(train_smote}\OperatorTok{$}\NormalTok{Class)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##     0     1 
## 60400 60702
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Identify the Predictors and the dependent variable, aka label.}
\NormalTok{predictors <-}\StringTok{ }\KeywordTok{colnames}\NormalTok{(train_smote[}\OperatorTok{-}\KeywordTok{ncol}\NormalTok{(train_smote)]) }\CommentTok{#remove last column}
\CommentTok{#xgboost works only if the labels are numeric. Hence, convert the labels (Species) to numeric.}
\NormalTok{label <-}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(train_smote[,}\KeywordTok{ncol}\NormalTok{(train_smote)])}

\CommentTok{#Alas, xgboost works only if the numeric labels start from 0. Hence, subtract 1 from the label.}
\NormalTok{label <-}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(train_smote[,}\KeywordTok{ncol}\NormalTok{(train_smote)])}\OperatorTok{-}\DecValTok{1}
\KeywordTok{print}\NormalTok{(}\KeywordTok{table}\NormalTok{(label))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## label
##     0     1 
## 60400 60702
\end{verbatim}

\subsection{Setting Parameters for
XGBoost}\label{setting-parameters-for-xgboost}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# set parameters:}
\NormalTok{parameters <-}\StringTok{ }\KeywordTok{list}\NormalTok{(}
  \CommentTok{# General Parameters}
  \DataTypeTok{booster            =} \StringTok{"gbtree"}\NormalTok{,          }
  \DataTypeTok{silent             =} \DecValTok{0}\NormalTok{,                 }
  \CommentTok{# Booster Parameters}
  \DataTypeTok{eta                =} \FloatTok{0.3}\NormalTok{,               }
  \DataTypeTok{gamma              =} \DecValTok{0}\NormalTok{,                 }
  \DataTypeTok{max_depth          =} \DecValTok{6}\NormalTok{,                 }
  \DataTypeTok{min_child_weight   =} \DecValTok{1}\NormalTok{,                 }
  \DataTypeTok{subsample          =} \DecValTok{1}\NormalTok{,                 }
  \DataTypeTok{colsample_bytree   =} \DecValTok{1}\NormalTok{,                 }
  \DataTypeTok{colsample_bylevel  =} \DecValTok{1}\NormalTok{,                 }
  \DataTypeTok{lambda             =} \DecValTok{1}\NormalTok{,                 }
  \DataTypeTok{alpha              =} \DecValTok{0}\NormalTok{,                 }
  \CommentTok{# Task Parameters}
  \DataTypeTok{objective          =} \StringTok{"binary:logistic"}\NormalTok{,   }
  \DataTypeTok{eval_metric        =} \StringTok{"auc"}\NormalTok{,}
  \DataTypeTok{seed               =} \DecValTok{1900}               
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsection{Train Model}\label{train-model}

Train the model with the parameters set above and nrounds = 25
(increasing nrounds does not improve the model anymore). Plots show
increasing train and cv AUC in the beginning and stagnating at later
rounds as expected.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{## Training of models}
\CommentTok{# Original}
\NormalTok{cv.nround =}\StringTok{ }\DecValTok{200}\NormalTok{;  }\CommentTok{# Number of rounds. This can be set to a lower or higher value, if you wish, example: 150 or 250 or 300  }
\NormalTok{bst.cv <-}\StringTok{ }\KeywordTok{xgb.cv}\NormalTok{(}
  \DataTypeTok{param=}\NormalTok{parameters,}
  \DataTypeTok{data =} \KeywordTok{as.matrix}\NormalTok{(train_smote[,predictors]),}
  \DataTypeTok{label =}\NormalTok{ label,}
  \DataTypeTok{nfold =} \DecValTok{3}\NormalTok{,}
  \DataTypeTok{nrounds=}\NormalTok{cv.nround,}
  \DataTypeTok{prediction=}\NormalTok{T)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  train-auc:0.988126+0.000290 test-auc:0.987120+0.000203 
## [2]  train-auc:0.994458+0.000626 test-auc:0.993682+0.000973 
## [3]  train-auc:0.996438+0.000303 test-auc:0.995692+0.000592 
## [4]  train-auc:0.997409+0.000210 test-auc:0.996878+0.000309 
## [5]  train-auc:0.998177+0.000100 test-auc:0.997759+0.000171 
## [6]  train-auc:0.998640+0.000145 test-auc:0.998255+0.000200 
## [7]  train-auc:0.998912+0.000079 test-auc:0.998543+0.000171 
## [8]  train-auc:0.999116+0.000082 test-auc:0.998800+0.000144 
## [9]  train-auc:0.999324+0.000044 test-auc:0.999043+0.000009 
## [10] train-auc:0.999437+0.000048 test-auc:0.999184+0.000020 
## [11] train-auc:0.999559+0.000040 test-auc:0.999334+0.000016 
## [12] train-auc:0.999609+0.000043 test-auc:0.999400+0.000026 
## [13] train-auc:0.999674+0.000033 test-auc:0.999473+0.000032 
## [14] train-auc:0.999721+0.000038 test-auc:0.999529+0.000021 
## [15] train-auc:0.999774+0.000020 test-auc:0.999595+0.000016 
## [16] train-auc:0.999816+0.000006 test-auc:0.999658+0.000022 
## [17] train-auc:0.999855+0.000010 test-auc:0.999710+0.000013 
## [18] train-auc:0.999868+0.000009 test-auc:0.999729+0.000014 
## [19] train-auc:0.999893+0.000004 test-auc:0.999765+0.000009 
## [20] train-auc:0.999911+0.000008 test-auc:0.999791+0.000008 
## [21] train-auc:0.999932+0.000011 test-auc:0.999824+0.000011 
## [22] train-auc:0.999945+0.000008 test-auc:0.999845+0.000012 
## [23] train-auc:0.999952+0.000010 test-auc:0.999855+0.000020 
## [24] train-auc:0.999959+0.000010 test-auc:0.999868+0.000027 
## [25] train-auc:0.999964+0.000008 test-auc:0.999874+0.000027 
## [26] train-auc:0.999969+0.000007 test-auc:0.999884+0.000025 
## [27] train-auc:0.999976+0.000005 test-auc:0.999892+0.000026 
## [28] train-auc:0.999979+0.000005 test-auc:0.999909+0.000024 
## [29] train-auc:0.999982+0.000004 test-auc:0.999918+0.000021 
## [30] train-auc:0.999983+0.000004 test-auc:0.999922+0.000019 
## [31] train-auc:0.999985+0.000004 test-auc:0.999926+0.000021 
## [32] train-auc:0.999987+0.000003 test-auc:0.999931+0.000020 
## [33] train-auc:0.999988+0.000001 test-auc:0.999940+0.000017 
## [34] train-auc:0.999990+0.000002 test-auc:0.999942+0.000018 
## [35] train-auc:0.999990+0.000002 test-auc:0.999946+0.000021 
## [36] train-auc:0.999991+0.000003 test-auc:0.999949+0.000021 
## [37] train-auc:0.999993+0.000002 test-auc:0.999953+0.000022 
## [38] train-auc:0.999993+0.000002 test-auc:0.999955+0.000021 
## [39] train-auc:0.999994+0.000002 test-auc:0.999959+0.000020 
## [40] train-auc:0.999996+0.000002 test-auc:0.999962+0.000019 
## [41] train-auc:0.999997+0.000002 test-auc:0.999964+0.000019 
## [42] train-auc:0.999997+0.000002 test-auc:0.999966+0.000018 
## [43] train-auc:0.999998+0.000002 test-auc:0.999967+0.000017 
## [44] train-auc:0.999998+0.000001 test-auc:0.999970+0.000017 
## [45] train-auc:0.999998+0.000001 test-auc:0.999971+0.000018 
## [46] train-auc:0.999999+0.000001 test-auc:0.999972+0.000017 
## [47] train-auc:1.000000+0.000000 test-auc:0.999973+0.000018 
## [48] train-auc:1.000000+0.000000 test-auc:0.999974+0.000017 
## [49] train-auc:1.000000+0.000000 test-auc:0.999975+0.000016 
## [50] train-auc:1.000000+0.000000 test-auc:0.999977+0.000014 
## [51] train-auc:1.000000+0.000000 test-auc:0.999978+0.000014 
## [52] train-auc:1.000000+0.000000 test-auc:0.999979+0.000013 
## [53] train-auc:1.000000+0.000000 test-auc:0.999979+0.000014 
## [54] train-auc:1.000000+0.000000 test-auc:0.999979+0.000015 
## [55] train-auc:1.000000+0.000000 test-auc:0.999981+0.000013 
## [56] train-auc:1.000000+0.000000 test-auc:0.999981+0.000013 
## [57] train-auc:1.000000+0.000000 test-auc:0.999981+0.000013 
## [58] train-auc:1.000000+0.000000 test-auc:0.999983+0.000011 
## [59] train-auc:1.000000+0.000000 test-auc:0.999982+0.000013 
## [60] train-auc:1.000000+0.000000 test-auc:0.999983+0.000012 
## [61] train-auc:1.000000+0.000000 test-auc:0.999984+0.000011 
## [62] train-auc:1.000000+0.000000 test-auc:0.999985+0.000010 
## [63] train-auc:1.000000+0.000000 test-auc:0.999985+0.000010 
## [64] train-auc:1.000000+0.000000 test-auc:0.999984+0.000011 
## [65] train-auc:1.000000+0.000000 test-auc:0.999985+0.000010 
## [66] train-auc:1.000000+0.000000 test-auc:0.999985+0.000010 
## [67] train-auc:1.000000+0.000000 test-auc:0.999985+0.000011 
## [68] train-auc:1.000000+0.000000 test-auc:0.999986+0.000010 
## [69] train-auc:1.000000+0.000000 test-auc:0.999987+0.000010 
## [70] train-auc:1.000000+0.000000 test-auc:0.999987+0.000010 
## [71] train-auc:1.000000+0.000000 test-auc:0.999987+0.000010 
## [72] train-auc:1.000000+0.000000 test-auc:0.999987+0.000009 
## [73] train-auc:1.000000+0.000000 test-auc:0.999987+0.000009 
## [74] train-auc:1.000000+0.000000 test-auc:0.999987+0.000009 
## [75] train-auc:1.000000+0.000000 test-auc:0.999987+0.000009 
## [76] train-auc:1.000000+0.000000 test-auc:0.999988+0.000009 
## [77] train-auc:1.000000+0.000000 test-auc:0.999987+0.000009 
## [78] train-auc:1.000000+0.000000 test-auc:0.999988+0.000009 
## [79] train-auc:1.000000+0.000000 test-auc:0.999988+0.000009 
## [80] train-auc:1.000000+0.000000 test-auc:0.999987+0.000009 
## [81] train-auc:1.000000+0.000000 test-auc:0.999987+0.000009 
## [82] train-auc:1.000000+0.000000 test-auc:0.999988+0.000009 
## [83] train-auc:1.000000+0.000000 test-auc:0.999987+0.000009 
## [84] train-auc:1.000000+0.000000 test-auc:0.999987+0.000009 
## [85] train-auc:1.000000+0.000000 test-auc:0.999988+0.000009 
## [86] train-auc:1.000000+0.000000 test-auc:0.999987+0.000009 
## [87] train-auc:1.000000+0.000000 test-auc:0.999987+0.000009 
## [88] train-auc:1.000000+0.000000 test-auc:0.999987+0.000009 
## [89] train-auc:1.000000+0.000000 test-auc:0.999987+0.000009 
## [90] train-auc:1.000000+0.000000 test-auc:0.999987+0.000009 
## [91] train-auc:1.000000+0.000000 test-auc:0.999987+0.000009 
## [92] train-auc:1.000000+0.000000 test-auc:0.999987+0.000009 
## [93] train-auc:1.000000+0.000000 test-auc:0.999987+0.000010 
## [94] train-auc:1.000000+0.000000 test-auc:0.999987+0.000010 
## [95] train-auc:1.000000+0.000000 test-auc:0.999987+0.000010 
## [96] train-auc:1.000000+0.000000 test-auc:0.999987+0.000010 
## [97] train-auc:1.000000+0.000000 test-auc:0.999987+0.000010 
## [98] train-auc:1.000000+0.000000 test-auc:0.999986+0.000011 
## [99] train-auc:1.000000+0.000000 test-auc:0.999987+0.000010 
## [100]    train-auc:1.000000+0.000000 test-auc:0.999986+0.000011 
## [101]    train-auc:1.000000+0.000000 test-auc:0.999986+0.000011 
## [102]    train-auc:1.000000+0.000000 test-auc:0.999986+0.000011 
## [103]    train-auc:1.000000+0.000000 test-auc:0.999986+0.000011 
## [104]    train-auc:1.000000+0.000000 test-auc:0.999986+0.000011 
## [105]    train-auc:1.000000+0.000000 test-auc:0.999986+0.000011 
## [106]    train-auc:1.000000+0.000000 test-auc:0.999986+0.000011 
## [107]    train-auc:1.000000+0.000000 test-auc:0.999986+0.000011 
## [108]    train-auc:1.000000+0.000000 test-auc:0.999986+0.000011 
## [109]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000010 
## [110]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000010 
## [111]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000010 
## [112]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000010 
## [113]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000010 
## [114]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000010 
## [115]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000010 
## [116]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011 
## [117]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [118]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [119]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [120]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [121]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [122]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [123]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [124]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [125]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [126]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000010 
## [127]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011 
## [128]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011 
## [129]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000010 
## [130]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [131]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [132]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [133]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [134]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [135]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [136]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [137]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [138]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000009 
## [139]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000009 
## [140]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000009 
## [141]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000009 
## [142]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [143]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [144]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [145]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [146]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [147]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [148]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [149]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [150]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [151]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [152]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [153]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011 
## [154]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011 
## [155]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [156]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [157]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [158]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [159]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [160]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [161]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [162]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [163]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [164]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [165]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [166]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000010 
## [167]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011 
## [168]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011 
## [169]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011 
## [170]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000011 
## [171]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000011 
## [172]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000011 
## [173]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000011 
## [174]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000011 
## [175]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000011 
## [176]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000011 
## [177]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000011 
## [178]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000011 
## [179]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000011 
## [180]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000011 
## [181]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000011 
## [182]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000011 
## [183]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000011 
## [184]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000011 
## [185]    train-auc:1.000000+0.000000 test-auc:0.999988+0.000011 
## [186]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011 
## [187]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011 
## [188]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011 
## [189]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011 
## [190]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011 
## [191]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011 
## [192]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011 
## [193]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011 
## [194]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011 
## [195]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011 
## [196]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011 
## [197]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011 
## [198]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011 
## [199]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011 
## [200]    train-auc:1.000000+0.000000 test-auc:0.999987+0.000011
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Find where the minimum logloss occurred}
\NormalTok{min.loss.idx =}\StringTok{ }\KeywordTok{which.max}\NormalTok{(bst.cv}\OperatorTok{$}\NormalTok{evaluation_log[, test_auc_mean]) }
\KeywordTok{cat}\NormalTok{(}\StringTok{"Minimum logloss occurred in round : "}\NormalTok{, min.loss.idx, }\StringTok{"}\CharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Minimum logloss occurred in round :  139
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Minimum logloss}
\KeywordTok{print}\NormalTok{(bst.cv}\OperatorTok{$}\NormalTok{evaluation_log[min.loss.idx,])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    iter train_auc_mean train_auc_std test_auc_mean test_auc_std
## 1:  139              1             0     0.9999883 9.392662e-06
\end{verbatim}

\subsection{Predict}\label{predict}

Predict with dataset and set threshold of 0.5

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{## Make predictions}
\NormalTok{bst <-}\StringTok{ }\KeywordTok{xgboost}\NormalTok{(}
  \DataTypeTok{param=}\NormalTok{parameters,}
  \DataTypeTok{data =}\KeywordTok{as.matrix}\NormalTok{(train_smote[,predictors]), }\CommentTok{#training it without the output variable! }
  \DataTypeTok{label =}\NormalTok{ label,}
  \DataTypeTok{nrounds=}\NormalTok{min.loss.idx)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  train-auc:0.988286 
## [2]  train-auc:0.995025 
## [3]  train-auc:0.996358 
## [4]  train-auc:0.997692 
## [5]  train-auc:0.998161 
## [6]  train-auc:0.998605 
## [7]  train-auc:0.999029 
## [8]  train-auc:0.999174 
## [9]  train-auc:0.999332 
## [10] train-auc:0.999449 
## [11] train-auc:0.999527 
## [12] train-auc:0.999583 
## [13] train-auc:0.999652 
## [14] train-auc:0.999680 
## [15] train-auc:0.999759 
## [16] train-auc:0.999798 
## [17] train-auc:0.999830 
## [18] train-auc:0.999855 
## [19] train-auc:0.999878 
## [20] train-auc:0.999900 
## [21] train-auc:0.999931 
## [22] train-auc:0.999945 
## [23] train-auc:0.999957 
## [24] train-auc:0.999963 
## [25] train-auc:0.999971 
## [26] train-auc:0.999975 
## [27] train-auc:0.999977 
## [28] train-auc:0.999980 
## [29] train-auc:0.999982 
## [30] train-auc:0.999985 
## [31] train-auc:0.999987 
## [32] train-auc:0.999989 
## [33] train-auc:0.999989 
## [34] train-auc:0.999990 
## [35] train-auc:0.999991 
## [36] train-auc:0.999993 
## [37] train-auc:0.999994 
## [38] train-auc:0.999995 
## [39] train-auc:0.999995 
## [40] train-auc:0.999996 
## [41] train-auc:0.999996 
## [42] train-auc:0.999997 
## [43] train-auc:0.999998 
## [44] train-auc:0.999998 
## [45] train-auc:0.999999 
## [46] train-auc:0.999999 
## [47] train-auc:0.999999 
## [48] train-auc:0.999999 
## [49] train-auc:1.000000 
## [50] train-auc:1.000000 
## [51] train-auc:1.000000 
## [52] train-auc:1.000000 
## [53] train-auc:1.000000 
## [54] train-auc:1.000000 
## [55] train-auc:1.000000 
## [56] train-auc:1.000000 
## [57] train-auc:1.000000 
## [58] train-auc:1.000000 
## [59] train-auc:1.000000 
## [60] train-auc:1.000000 
## [61] train-auc:1.000000 
## [62] train-auc:1.000000 
## [63] train-auc:1.000000 
## [64] train-auc:1.000000 
## [65] train-auc:1.000000 
## [66] train-auc:1.000000 
## [67] train-auc:1.000000 
## [68] train-auc:1.000000 
## [69] train-auc:1.000000 
## [70] train-auc:1.000000 
## [71] train-auc:1.000000 
## [72] train-auc:1.000000 
## [73] train-auc:1.000000 
## [74] train-auc:1.000000 
## [75] train-auc:1.000000 
## [76] train-auc:1.000000 
## [77] train-auc:1.000000 
## [78] train-auc:1.000000 
## [79] train-auc:1.000000 
## [80] train-auc:1.000000 
## [81] train-auc:1.000000 
## [82] train-auc:1.000000 
## [83] train-auc:1.000000 
## [84] train-auc:1.000000 
## [85] train-auc:1.000000 
## [86] train-auc:1.000000 
## [87] train-auc:1.000000 
## [88] train-auc:1.000000 
## [89] train-auc:1.000000 
## [90] train-auc:1.000000 
## [91] train-auc:1.000000 
## [92] train-auc:1.000000 
## [93] train-auc:1.000000 
## [94] train-auc:1.000000 
## [95] train-auc:1.000000 
## [96] train-auc:1.000000 
## [97] train-auc:1.000000 
## [98] train-auc:1.000000 
## [99] train-auc:1.000000 
## [100]    train-auc:1.000000 
## [101]    train-auc:1.000000 
## [102]    train-auc:1.000000 
## [103]    train-auc:1.000000 
## [104]    train-auc:1.000000 
## [105]    train-auc:1.000000 
## [106]    train-auc:1.000000 
## [107]    train-auc:1.000000 
## [108]    train-auc:1.000000 
## [109]    train-auc:1.000000 
## [110]    train-auc:1.000000 
## [111]    train-auc:1.000000 
## [112]    train-auc:1.000000 
## [113]    train-auc:1.000000 
## [114]    train-auc:1.000000 
## [115]    train-auc:1.000000 
## [116]    train-auc:1.000000 
## [117]    train-auc:1.000000 
## [118]    train-auc:1.000000 
## [119]    train-auc:1.000000 
## [120]    train-auc:1.000000 
## [121]    train-auc:1.000000 
## [122]    train-auc:1.000000 
## [123]    train-auc:1.000000 
## [124]    train-auc:1.000000 
## [125]    train-auc:1.000000 
## [126]    train-auc:1.000000 
## [127]    train-auc:1.000000 
## [128]    train-auc:1.000000 
## [129]    train-auc:1.000000 
## [130]    train-auc:1.000000 
## [131]    train-auc:1.000000 
## [132]    train-auc:1.000000 
## [133]    train-auc:1.000000 
## [134]    train-auc:1.000000 
## [135]    train-auc:1.000000 
## [136]    train-auc:1.000000 
## [137]    train-auc:1.000000 
## [138]    train-auc:1.000000 
## [139]    train-auc:1.000000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Make prediction on the testing data.}
\NormalTok{test}\OperatorTok{$}\NormalTok{prediction <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(bst, }\KeywordTok{as.matrix}\NormalTok{(test[,predictors])) }\CommentTok{#here, I've removed the output variable....}

\NormalTok{test}\OperatorTok{$}\NormalTok{prediction <-}\StringTok{ }\KeywordTok{ifelse}\NormalTok{(test}\OperatorTok{$}\NormalTok{prediction }\OperatorTok{>=}\StringTok{ }\FloatTok{0.5}\NormalTok{, }\DecValTok{1}\NormalTok{ , }\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsection{Confusion Matrix}\label{confusion-matrix}

Sensitivity (TPR) = 0.9991 Specificity (TNR) = 0.9135 Accuracy = 0.9989

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Compute the accuracy of predictions.}
\NormalTok{confmatrix_table <-}\StringTok{ }\KeywordTok{confusionMatrix}\NormalTok{(}\KeywordTok{as.factor}\NormalTok{(test}\OperatorTok{$}\NormalTok{prediction), }\KeywordTok{as.factor}\NormalTok{(test}\OperatorTok{$}\NormalTok{Class)) }\CommentTok{#sensitivity (TPR) = 0.9991, specificity = 0.9135}
\CommentTok{#accuracy = 0.9989}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{plot_confusion_matrix <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(test_df, sSubtitle) \{}
\NormalTok{  tst <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\KeywordTok{round}\NormalTok{(test_df}\OperatorTok{$}\NormalTok{prediction,}\DecValTok{0}\NormalTok{), test_df}\OperatorTok{$}\NormalTok{Class)}
\NormalTok{  opts <-}\StringTok{  }\KeywordTok{c}\NormalTok{(}\StringTok{"Predicted"}\NormalTok{, }\StringTok{"True"}\NormalTok{)}
  \KeywordTok{names}\NormalTok{(tst) <-}\StringTok{ }\NormalTok{opts}
\NormalTok{  cf <-}\StringTok{ }\NormalTok{plyr}\OperatorTok{::}\KeywordTok{count}\NormalTok{(tst)}
\NormalTok{  cf[opts][cf[opts]}\OperatorTok{==}\DecValTok{0}\NormalTok{] <-}\StringTok{ "Not Fraud"}
\NormalTok{  cf[opts][cf[opts]}\OperatorTok{==}\DecValTok{1}\NormalTok{] <-}\StringTok{ "Fraud"}
  
  \KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =}\NormalTok{  cf, }\DataTypeTok{mapping =} \KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ True, }\DataTypeTok{y =}\NormalTok{ Predicted)) }\OperatorTok{+}
\StringTok{    }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title =} \StringTok{"Confusion matrix"}\NormalTok{, }\DataTypeTok{subtitle =}\NormalTok{ sSubtitle) }\OperatorTok{+}
\StringTok{    }\KeywordTok{geom_tile}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{fill =}\NormalTok{ freq), }\DataTypeTok{colour =} \StringTok{"grey"}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{geom_text}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{label =} \KeywordTok{sprintf}\NormalTok{(}\StringTok{"%1.0f"}\NormalTok{, freq)), }\DataTypeTok{vjust =} \DecValTok{1}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{scale_fill_gradient}\NormalTok{(}\DataTypeTok{low =} \StringTok{"lightblue"}\NormalTok{, }\DataTypeTok{high =} \StringTok{"Green"}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{theme_bw}\NormalTok{() }\OperatorTok{+}\StringTok{ }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{legend.position =} \StringTok{"none"}\NormalTok{)}
  
\NormalTok{\}}

\KeywordTok{plot_confusion_matrix}\NormalTok{(test, }\KeywordTok{paste}\NormalTok{(}\StringTok{"XGBoost with"}\NormalTok{, }\KeywordTok{paste}\NormalTok{(}\StringTok{"min logloss at round: "}\NormalTok{, min.loss.idx, }\StringTok{"}\CharTok{\textbackslash{}n}\StringTok{"}\NormalTok{),}
                                  \StringTok{"Sensitivity:"}\NormalTok{, }\KeywordTok{round}\NormalTok{(confmatrix_table[[}\DecValTok{4}\NormalTok{]][}\DecValTok{1}\NormalTok{], }\DecValTok{4}\NormalTok{), }\StringTok{"}\CharTok{\textbackslash{}n}\StringTok{"}\NormalTok{,}
                                  \StringTok{"Specificity:"}\NormalTok{, }\KeywordTok{round}\NormalTok{(confmatrix_table[[}\DecValTok{4}\NormalTok{]][}\DecValTok{2}\NormalTok{], }\DecValTok{4}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Guide_files/figure-latex/unnamed-chunk-8-1.pdf}

\subsection{Importance Matrix}\label{importance-matrix}

Identify features that are most important

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{##plot feature importance}
\NormalTok{importance_matrix <-}\StringTok{ }\KeywordTok{xgb.importance}\NormalTok{(}\DataTypeTok{model =}\NormalTok{ bst)}
\KeywordTok{xgb.plot.importance}\NormalTok{(importance_matrix)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Guide_files/figure-latex/unnamed-chunk-9-1.pdf}

\subsection{ROC Curve}\label{roc-curve}

AUC = 0.956

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{###############################################################}
\KeywordTok{library}\NormalTok{(ROCR)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: gplots
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'gplots'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:stats':
## 
##     lowess
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Use ROCR package to plot ROC Curve}
\NormalTok{xgb.pred <-}\StringTok{ }\KeywordTok{prediction}\NormalTok{(test}\OperatorTok{$}\NormalTok{prediction, test}\OperatorTok{$}\NormalTok{Class)}
\NormalTok{xgb.perf <-}\StringTok{ }\KeywordTok{performance}\NormalTok{(xgb.pred, }\StringTok{"tpr"}\NormalTok{, }\StringTok{"fpr"}\NormalTok{)}

\KeywordTok{plot}\NormalTok{(xgb.perf,}
     \DataTypeTok{avg=}\StringTok{"threshold"}\NormalTok{,}
     \DataTypeTok{colorize=}\OtherTok{TRUE}\NormalTok{,}
     \DataTypeTok{lwd=}\DecValTok{1}\NormalTok{,}
     \DataTypeTok{main=}\StringTok{"ROC Curve w/ Thresholds"}\NormalTok{,}
     \DataTypeTok{print.cutoffs.at=}\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DataTypeTok{by=}\FloatTok{0.05}\NormalTok{),}
     \DataTypeTok{text.adj=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\FloatTok{0.5}\NormalTok{, }\FloatTok{0.5}\NormalTok{),}
     \DataTypeTok{text.cex=}\FloatTok{0.5}\NormalTok{)}
\KeywordTok{grid}\NormalTok{(}\DataTypeTok{col=}\StringTok{"lightgray"}\NormalTok{)}
\KeywordTok{axis}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DataTypeTok{at=}\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DataTypeTok{by=}\FloatTok{0.1}\NormalTok{))}
\KeywordTok{axis}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DataTypeTok{at=}\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DataTypeTok{by=}\FloatTok{0.1}\NormalTok{))}
\KeywordTok{abline}\NormalTok{(}\DataTypeTok{v=}\KeywordTok{c}\NormalTok{(}\FloatTok{0.1}\NormalTok{, }\FloatTok{0.3}\NormalTok{, }\FloatTok{0.5}\NormalTok{, }\FloatTok{0.7}\NormalTok{, }\FloatTok{0.9}\NormalTok{), }\DataTypeTok{col=}\StringTok{"lightgray"}\NormalTok{, }\DataTypeTok{lty=}\StringTok{"dotted"}\NormalTok{)}
\KeywordTok{abline}\NormalTok{(}\DataTypeTok{h=}\KeywordTok{c}\NormalTok{(}\FloatTok{0.1}\NormalTok{, }\FloatTok{0.3}\NormalTok{, }\FloatTok{0.5}\NormalTok{, }\FloatTok{0.7}\NormalTok{, }\FloatTok{0.9}\NormalTok{), }\DataTypeTok{col=}\StringTok{"lightgray"}\NormalTok{, }\DataTypeTok{lty=}\StringTok{"dotted"}\NormalTok{)}
\KeywordTok{lines}\NormalTok{(}\DataTypeTok{x=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{), }\DataTypeTok{y=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{), }\DataTypeTok{col=}\StringTok{"black"}\NormalTok{, }\DataTypeTok{lty=}\StringTok{"dotted"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Guide_files/figure-latex/unnamed-chunk-10-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{auc_ROCR <-}\StringTok{ }\KeywordTok{performance}\NormalTok{(xgb.pred, }\DataTypeTok{measure =} \StringTok{"auc"}\NormalTok{) }\CommentTok{#gives the AUC rate}
\NormalTok{auc_ROCR <-}\StringTok{ }\NormalTok{auc_ROCR}\OperatorTok{@}\NormalTok{y.values[[}\DecValTok{1}\NormalTok{]] }
\NormalTok{auc_ROCR }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.9562559
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#AUC = 0.956}
\end{Highlighting}
\end{Shaded}




\newpage
\singlespacing 
\end{document}
